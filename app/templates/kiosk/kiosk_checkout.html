{% extends "kiosk/base.html" %}

{% block title %}Confirmar Pedido - Club Bimba{% endblock %}

{% block content %}
<div class="checkout-screen">
    <div class="screen-header">
        <h1>Confirma tu pedido</h1>
        <button class="btn-secondary btn-small" onclick="window.location.href='{{ url_for('kiosk.kiosk_products') }}'">
            Volver
        </button>
    </div>
    
    <div class="checkout-content">
        <div class="checkout-items" id="checkout-items">
            <!-- Se llenará con JavaScript -->
        </div>
        
        <div class="checkout-total">
            <div class="total-line">
                <span>Total a pagar:</span>
                <span id="checkout-total-amount">$0</span>
            </div>
        </div>
        
        <div class="checkout-actions">
            <button class="btn-secondary btn-large" onclick="window.location.href='{{ url_for('kiosk.kiosk_products') }}'">
                ← Volver a Productos
            </button>
            <div style="display: flex; flex-direction: column; gap: 1rem; width: 100%; margin-top: 2rem;">
                <p style="text-align: center; color: #666; padding: 1rem;">
                    Acércate a la caja para realizar el pago en efectivo.
                </p>
            </div>
        </div>
    </div>
</div>


<script>
// Cargar carrito desde localStorage
let carritoItems = [];

function cargarCarrito() {
    const carritoData = localStorage.getItem('carrito_pendiente');
    if (carritoData) {
        carritoItems = JSON.parse(carritoData);
        mostrarCarrito();
    } else {
        // Si no hay carrito, volver a productos
        window.location.href = '{{ url_for("kiosk.kiosk_products") }}';
    }
}

function mostrarCarrito() {
    const itemsEl = document.getElementById('checkout-items');
    const totalEl = document.getElementById('checkout-total-amount');
    
    let html = '';
    let total = 0;
    
    carritoItems.forEach(item => {
        total += item.total;
        html += `
            <div class="checkout-item">
                <div class="checkout-item-info">
                    <span class="checkout-item-nombre">${item.nombre}</span>
                    <span class="checkout-item-detalle">${item.cantidad} x $${item.precio.toLocaleString()}</span>
                </div>
                <span class="checkout-item-subtotal">$${item.total.toLocaleString()}</span>
            </div>
        `;
    });
    
    itemsEl.innerHTML = html;
    totalEl.textContent = `$${total.toLocaleString()}`;
}


// Cargar carrito al iniciar
cargarCarrito();
</script>
{% endblock %}


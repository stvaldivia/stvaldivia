<!-- Modal de Galleta de la Fortuna -->
<div id="galleta-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); z-index: 99999; align-items: center; justify-content: center;">
    <div style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); border: 3px solid rgba(255, 215, 0, 0.6); border-radius: 20px; padding: 50px; max-width: 600px; width: 90%; text-align: center; position: relative; box-shadow: 0 20px 60px rgba(255, 215, 0, 0.4);">
        <button onclick="cerrarGalleta();" style="position: absolute; top: 15px; right: 15px; background: transparent; border: none; color: #fff; font-size: 28px; cursor: pointer; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s; z-index: 100000;">&times;</button>
        
        <div style="font-size: 80px; margin-bottom: 20px; animation: pulse 2s infinite;">ğŸª</div>
        
        <h2 style="color: #ffd700; font-size: 2rem; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">Galleta de la Fortuna</h2>
        
        <div id="galleta-mensaje" style="background: rgba(255, 215, 0, 0.15); border: 2px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 30px; margin: 30px 0; min-height: 120px; display: flex; align-items: center; justify-content: center;">
            <p id="galleta-texto" style="color: #e8e8e8; font-size: 1.3rem; line-height: 1.6; margin: 0; font-style: italic;">Cargando tu fortuna...</p>
        </div>
        
        <div style="margin-top: 30px;">
            <button onclick="cerrarGalleta();" style="background: linear-gradient(135deg, #4caf50 0%, #45a049 100%); border: none; color: white; padding: 15px 40px; font-size: 1.2rem; border-radius: 10px; cursor: pointer; font-weight: bold; transition: all 0.3s; box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);">
                âœ… Continuar
            </button>
        </div>
    </div>
</div>

<style>
@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

#galleta-modal {
    animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}
</style>

<script>
// Mensajes de galleta de la fortuna para trabajadores
const mensajesGalleta = [
    "ğŸ‰ Hoy serÃ¡ un dÃ­a excepcional. Tu dedicaciÃ³n serÃ¡ recompensada.",
    "ğŸ’° El Ã©xito te espera. Cada acciÃ³n cuenta para alcanzar tus metas.",
    "ğŸš€ La energÃ­a positiva te acompaÃ±arÃ¡ durante toda tu jornada.",
    "â­ Tu excelencia brillarÃ¡ en cada tarea que realices.",
    "ğŸ’ª La dedicaciÃ³n de hoy construye el Ã©xito de maÃ±ana.",
    "ğŸ¯ EnfÃ³cate en cada detalle. Los pequeÃ±os gestos hacen la diferencia.",
    "ğŸŒŸ La buena fortuna estÃ¡ de tu lado. ConfÃ­a en ti mismo.",
    "ğŸ”¥ Tu entusiasmo es contagioso. Inspira a quienes te rodean.",
    "ğŸ’ Las oportunidades estÃ¡n por todas partes. MantÃ©n los ojos abiertos.",
    "ğŸŠ La alegrÃ­a y la satisfacciÃ³n llenarÃ¡n tu jornada de trabajo.",
    "âœ¨ Cada momento cuenta. Aprovecha al mÃ¡ximo esta oportunidad.",
    "ğŸ† El trabajo en equipo serÃ¡ clave para el Ã©xito de hoy.",
    "ğŸŒˆ DespuÃ©s del esfuerzo viene la recompensa. Hoy serÃ¡ brillante.",
    "ğŸ Las sorpresas agradables estÃ¡n por venir. MantÃ©n la mente abierta.",
    "âš¡ Tu velocidad y precisiÃ³n serÃ¡n tus aliadas hoy.",
    "ğŸ¨ Tu creatividad resolverÃ¡ cualquier desafÃ­o que se presente.",
    "ğŸŒ™ Bajo las estrellas, la magia ocurrirÃ¡. Esta noche serÃ¡ especial.",
    "ğŸ’¼ Tu profesionalidad abrirÃ¡ todas las puertas del Ã©xito.",
    "ğŸª El espectÃ¡culo estÃ¡ a punto de comenzar. Â¡Que empiece la funciÃ³n!",
    "ğŸŒŸ Tu actitud positiva atraerÃ¡ resultados extraordinarios.",
    "ğŸ’« Cada cliente es una oportunidad de brillar. Demuestra tu mejor versiÃ³n.",
    "ğŸ­ El trabajo bien hecho es tu mejor carta de presentaciÃ³n.",
    "ğŸ”¥ Tu pasiÃ³n se notarÃ¡ en cada interacciÃ³n. Deja huella positiva.",
    "âš¡ MantÃ©n el ritmo, la eficiencia es tu aliada hoy.",
    "ğŸŒº Tu sonrisa y amabilidad harÃ¡n la diferencia esta jornada."
];

function mostrarGalletaFortuna() {
    console.log('ğŸª mostrarGalletaFortuna() llamado');
    
    // Seleccionar un mensaje aleatorio
    const mensajeAleatorio = mensajesGalleta[Math.floor(Math.random() * mensajesGalleta.length)];
    
    // Mostrar el modal
    const modal = document.getElementById('galleta-modal');
    const texto = document.getElementById('galleta-texto');
    
    console.log('ğŸ” Modal encontrado:', !!modal);
    console.log('ğŸ” Texto encontrado:', !!texto);
    
    if (modal && texto) {
        texto.textContent = mensajeAleatorio;
        modal.style.display = 'flex';
        
        console.log('âœ… Modal mostrado');
        console.log('ğŸ’¬ Mensaje:', mensajeAleatorio);
        
        // Agregar efecto de animaciÃ³n al texto
        texto.style.animation = 'fadeIn 0.5s ease-in';
    } else {
        console.error('âŒ Error: No se encontrÃ³ el modal o el texto');
        console.error('Modal:', modal);
        console.error('Texto:', texto);
    }
}

function cerrarGalleta() {
    const modal = document.getElementById('galleta-modal');
    if (modal) {
        modal.style.display = 'none';
        
        // Llamar a callback si existe
        if (window.onGalletaCerrada) {
            window.onGalletaCerrada();
        }
    }
}

// Cerrar con Escape
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        cerrarGalleta();
    }
});

// Verificar si debe mostrarse automÃ¡ticamente al cargar la pÃ¡gina
(function() {
    function initGalleta() {
        console.log('ğŸª Inicializando galleta de la fortuna...');
        
        // Verificar si hay un parÃ¡metro en la URL
        const urlParams = new URLSearchParams(window.location.search);
        const showCookie = urlParams.get('show_fortune') === 'true';
        
        console.log('ğŸ” ParÃ¡metro show_fortune:', showCookie);
        console.log('ğŸ“ URL completa:', window.location.href);
        
        if (showCookie) {
            // Verificar si ya se mostrÃ³ en esta sesiÃ³n para esta URL especÃ­fica
            const currentUrl = window.location.pathname;
            const galletaKey = `galleta_mostrada_${currentUrl}`;
            const alreadyShown = sessionStorage.getItem(galletaKey) === 'true';
            
            console.log('ğŸ”‘ Clave de sesiÃ³n:', galletaKey);
            console.log('ğŸ‘ï¸ Ya se mostrÃ³ antes:', alreadyShown);
            
            if (!alreadyShown) {
                console.log('âœ… Mostrando galleta en 800ms...');
                // Esperar un momento para que la pÃ¡gina cargue completamente
                setTimeout(() => {
                    console.log('ğŸš€ Ejecutando mostrarGalletaFortuna()');
                    mostrarGalletaFortuna();
                    // Marcar como mostrada para esta pÃ¡gina
                    sessionStorage.setItem(galletaKey, 'true');
                    console.log('ğŸ’¾ Galleta marcada como mostrada');
                }, 800);
            } else {
                console.log('â­ï¸ Galleta ya mostrada anteriormente, omitiendo...');
            }
        } else {
            console.log('â„¹ï¸ No se debe mostrar la galleta (parÃ¡metro show_fortune no estÃ¡ en true)');
        }
    }
    
    // Intentar ejecutar cuando el DOM estÃ© listo
    if (document.readyState === 'loading') {
        console.log('ğŸ“„ DOM cargando, esperando DOMContentLoaded...');
        document.addEventListener('DOMContentLoaded', initGalleta);
    } else {
        console.log('ğŸ“„ DOM ya cargado, ejecutando inmediatamente...');
        // Si ya estÃ¡ cargado, ejecutar inmediatamente
        initGalleta();
    }
})();
</script>

